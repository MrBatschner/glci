glci:
  base_definition:
    traits:
      notifications:
        default:
          on_error:
            triggering_policy: 'never'

  jobs:
    on-head-update:
      repo:
        trigger: false
      repos:
      - name: 'GARDENLINUX'
        cfg_name: 'github_com'
        path: 'gardenlinux/gardenlinux'
        branch: 'main'
      steps:
        render_pipelines_and_trigger_job:
          execute:
          - '../ci/render_pipelines_and_trigger_job'
          vars:
            PROMOTE_TARGET: "'release'"
            BUILD_TARGETS: "'build,manifest,component-descriptor,publish,freeze-version'"

    update-job-image:
      repo:
        trigger: false
      traits:
        publish:
          dockerimages:
            job-image:
              image: 'eu.gcr.io/gardener-project/glci/job-image'
              dockerfile: 'Dockerfile'
              tag_as_latest: true
        version:
          versionfile: 'job-image-version'
        release:
          release_on_github: false
